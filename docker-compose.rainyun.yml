services:
  backend:
    image: anoinex/banana-slides-backend:latest
    container_name: banana-slides-backend
    ports:
      - "${BACKEND_PORT}:5000"
    environment:
      AI_PROVIDER_FORMAT: gemini
      GOOGLE_API_KEY: "replace-with-your-google-api-key"
      GOOGLE_API_BASE: https://generativelanguage.googleapis.com
      GENAI_TIMEOUT: "300.0"
      GENAI_MAX_RETRIES: "2"
      OPENAI_API_KEY: ""
      OPENAI_API_BASE: https://api.openai.com/v1
      OPENAI_TIMEOUT: "300.0"
      OPENAI_MAX_RETRIES: "2"
      TEXT_MODEL: gemini-3-flash-preview
      IMAGE_MODEL: gemini-3-pro-image-preview
      LOG_LEVEL: INFO
      FLASK_ENV: production
      SECRET_KEY: "replace-with-a-strong-secret-key"
      BACKEND_PORT: "5000"
      CORS_ORIGINS: "*"
      MAX_DESCRIPTION_WORKERS: "5"
      MAX_IMAGE_WORKERS: "8"
      MINERU_TOKEN: ""
      MINERU_API_BASE: https://mineru.net
      IMAGE_CAPTION_MODEL: gemini-3-flash-preview
      BAIDU_OCR_API_KEY: ""
      OUTPUT_LANGUAGE: zh
    volumes:
      - ./backend/instance:/app/backend/instance
      - ./uploads:/app/uploads
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

  frontend:
    image: anoinex/banana-slides-frontend:latest
    container_name: banana-slides-frontend
    ports:
      - "${FRONTEND_PORT}:80"
    environment:
      FRONTEND_PORT: "3000"
    depends_on:
      - backend
    restart: unless-stopped
